<div class="card">
  <div class="card-header">
    <h5 class="card-title mb-0">{{ 'ADMIN.EMISOR.MODULES.TITLE' | translate }}</h5>
  </div>
  <div class="card-body">
    <div class="row g-3">
      @for (moduleKey of moduleKeys; track trackByModuleKey($index, moduleKey)) {
        <div class="col-md-4 col-lg-3">
          <div class="form-check form-switch">
            <input
              class="form-check-input"
              type="checkbox"
              role="switch"
              [id]="'toggle_' + moduleKey"
              [checked]="isModuleActive(moduleKey)"
              (change)="onToggle(moduleKey, $event)"
            />
            <label class="form-check-label" [for]="'toggle_' + moduleKey">
              {{ moduleKey }}
            </label>
          </div>

          @if (moduleKey === 'INVOICING' && isModuleActive(moduleKey)) {
            <div class="mt-2">
              @if (sourceEmisorId) {
                <span class="badge bg-success-subtle text-success">
                  <i class="ti ti-link me-1"></i>
                  {{ 'ADMIN.EMISOR.MODULES.LINKED' | translate }} #{{ sourceEmisorId }}
                </span>
              } @else {
                <button
                  class="btn btn-sm btn-outline-warning"
                  (click)="onSyncInvoicing()"
                  [disabled]="isSyncing"
                >
                  @if (isSyncing) {
                    <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                  } @else {
                    <i class="ti ti-refresh me-1"></i>
                  }
                  {{ 'ADMIN.EMISOR.MODULES.SYNC_INVOICING' | translate }}
                </button>
              }
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
